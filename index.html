<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sinalizar — Comunicação visual</title>

    <!-- Roboto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root { color-scheme: light; }
        html, body {
            max-width: 100vw;
            overflow-x: hidden;
        }
        * { box-sizing: border-box; }
        body { font-family: 'Roboto', system-ui, -apple-system, Segoe UI, Arial, sans-serif; }
        .nice-scroll { scrollbar-width: thin; scrollbar-color: #cbd5e1 transparent; }
        .nice-scroll::-webkit-scrollbar { height: 8px; width: 8px; }
        .nice-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 9999px; }
        .break-anywhere { overflow-wrap: anywhere; }
    </style>
</head>

<body class="bg-[#f47d35] min-h-screen text-white p-2 sm:p-4">
    <div class="w-full max-w-4xl mx-auto">
        <header class="mb-4 text-center sm:text-left">
            <h1 class="text-2xl sm:text-3xl font-bold">Sinalizar</h1>
            <p class="text-lg sm:text-xl">Comunicação visual</p>
        </header>

        <main class="w-full space-y-4">
            <!-- Calendário Inteligente -->
            <section class="bg-white text-black rounded-2xl shadow-sm p-3 sm:p-6">
                <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 mb-3">
                    <div>
                        <h2 id="cal-title" class="text-lg sm:text-xl font-semibold">Calendário</h2>
                        <p class="text-xs sm:text-sm text-slate-500">Visual mensal.</p>
                    </div>
                    <div id="cal-controls" class="flex items-center gap-2">
                        <button id="btn-today" class="px-3 py-1 text-sm rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50">Hoje</button>
                        <div class="flex rounded-xl border border-slate-200 overflow-hidden">
                            <button id="btn-prev" class="px-2 sm:px-3 py-1 hover:bg-slate-50">◀</button>
                            <button id="btn-next" class="px-2 sm:px-3 py-1 hover:bg-slate-50">▶</button>
                        </div>
                    </div>
                </div>

                <!-- A MUDANÇA PRINCIPAL ESTÁ AQUI -->
                <!-- Container para a Grade (Desktop) -->
                <div id="calendar-grid-container">
                    <div class="rounded-2xl border border-slate-200">
                        <div class="grid grid-cols-7 bg-slate-50 border-b border-slate-200 text-[10px] text-slate-600">
                            <div class="p-1 text-center font-bold">SEG</div>
                            <div class="p-1 text-center font-bold">TER</div>
                            <div class="p-1 text-center font-bold">QUA</div>
                            <div class="p-1 text-center font-bold">QUI</div>
                            <div class="p-1 text-center font-bold">SEX</div>
                            <div class="p-1 text-center font-bold">SAB</div>
                            <div class="p-1 text-center font-bold">DOM</div>
                        </div>
                        <div id="cal-grid" class="grid grid-cols-7 auto-rows-[minmax(38px,1fr)]"></div>
                    </div>
                </div>

                <!-- Container para a Lista (Celular) -->
                <div id="calendar-list-container" class="hidden">
                    <ul id="cal-list" class="space-y-1 max-h-[260px] overflow-y-auto nice-scroll border border-slate-200 rounded-2xl p-2">
                        <!-- O JavaScript vai preencher esta lista -->
                    </ul>
                </div>

            </section>

            <!-- Lista de Tarefas -->
            <section class="bg-white text-black rounded-2xl shadow-sm p-3 sm:p-6">
                <h2 class="text-lg sm:text-xl font-semibold mb-3">Lista de Tarefas</h2>
                <div class="flex flex-col sm:flex-row gap-2 mb-3">
                    <input id="todo-input" type="text" class="w-full sm:flex-1 rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm" placeholder="Adicionar nova tarefa...">
                    <button id="todo-add" class="w-full sm:w-auto px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 text-sm">Adicionar</button>
                </div>
                <ul id="todo-list" class="nice-scroll max-h-80 overflow-y-auto space-y-2"></ul>
            </section>

            <!-- Bloco de Notas -->
            <section class="bg-white text-black rounded-2xl shadow-sm p-3 sm:p-6">
                <div class="flex items-center justify-between mb-3">
                    <h2 class="text-lg sm:text-xl font-semibold">Bloco de Notas</h2>
                    <button id="note-new" class="px-3 py-1 rounded-xl bg-emerald-600 text-white hover:bg-emerald-700 text-sm">Nova nota</button>
                </div>
                <div id="note-form" class="hidden mb-4 rounded-2xl border border-slate-200 p-3">
                    <div class="flex flex-col gap-2">
                        <input id="note-title" type="text" class="rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-sm" placeholder="Título (opcional)">
                        <textarea id="note-body" rows="3" class="rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-sm" placeholder="Digite sua nota..."></textarea>
                        <div class="flex items-center gap-2 justify-end">
                            <button id="note-cancel" class="px-3 py-1 rounded-xl border border-slate-200 hover:bg-slate-50 text-sm">Cancelar</button>
                            <button id="note-save" class="px-3 py-1 rounded-xl bg-emerald-600 text-white hover:bg-emerald-700 text-sm">Salvar</button>
                        </div>
                    </div>
                </div>
                <div id="note-list" class="nice-scroll max-h-80 overflow-y-auto space-y-2"></div>
            </section>
        </main>
    </div>

<script>
// O SCRIPT FOI ATUALIZADO COM A LÓGICA INTELIGENTE
const store = {
  get(key,fallback){ try { return JSON.parse(localStorage.getItem(key)) ?? fallback } catch { return fallback } },
  set(key,value){ localStorage.setItem(key, JSON.stringify(value)); }
};
const calGrid = document.getElementById('cal-grid');
const calList = document.getElementById('cal-list');
const calTitle = document.getElementById('cal-title');
const btnPrev = document.getElementById('btn-prev');
const btnNext = document.getElementById('btn-next');
const btnToday = document.getElementById('btn-today');
let current = new Date();
function startOfMonth(date){ return new Date(date.getFullYear(), date.getMonth(), 1); }
function endOfMonth(date){ return new Date(date.getFullYear(), date.getMonth()+1,0); }
function isSameDay(a,b){ return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate(); }

function renderCalendar(){
  const monthStart = startOfMonth(current);
  const monthEnd = endOfMonth(current);
  const startWeekIndex = (monthStart.getDay()+6)%7;
  const daysInMonth = monthEnd.getDate();
  const formatter = new Intl.DateTimeFormat('pt-BR',{month:'long',year:'numeric'});
  const title = formatter.format(current);
  calTitle.textContent = title.charAt(0).toUpperCase() + title.slice(1);
  const today = new Date();

  // Renderiza a Grade
  calGrid.innerHTML = "";
  for(let i=0;i<startWeekIndex;i++){
    const cell = document.createElement('div'); cell.className="border-t border-r border-slate-200 bg-slate-50"; calGrid.appendChild(cell);
  }
  for(let d=1;d<=daysInMonth;d++){
    const date = new Date(current.getFullYear(), current.getMonth(), d);
    const isToday = isSameDay(date,today);
    const cell = document.createElement('div');
    cell.className="border-t border-r border-slate-200 relative flex items-center justify-center";
    cell.innerHTML=`<div class="flex items-center justify-center w-6 h-6 text-xs ${isToday?'bg-blue-600 text-white':'text-slate-700'} rounded-full">${d}</div>`;
    calGrid.appendChild(cell);
  }

  // Renderiza a Lista
  calList.innerHTML = "";
  for(let d=1; d<=daysInMonth; d++){
      const date = new Date(current.getFullYear(), current.getMonth(), d);
      const isToday = isSameDay(date, today);
      const dayNameFormatter = new Intl.DateTimeFormat('pt-BR', { weekday: 'long' });
      const dayName = dayNameFormatter.format(date);

      const li = document.createElement('li');
      li.className = `flex items-center justify-between p-2 rounded-lg ${isToday ? 'bg-orange-100' : ''}`;
      li.innerHTML = `
        <div class="flex items-center">
            <div class="flex items-center justify-center w-8 h-8 font-bold text-md ${isToday ? 'text-orange-600' : 'text-slate-700'}">${d}</div>
            <div class="ml-3 ${isToday ? 'font-bold text-orange-700' : 'text-slate-600'}">${dayName.charAt(0).toUpperCase() + dayName.slice(1)}</div>
        </div>
        ${isToday ? '<span class="text-xs font-bold text-orange-600">HOJE</span>' : ''}
      `;
      calList.appendChild(li);
  }
}

function handleResponsiveLayout(){
    const gridContainer = document.getElementById('calendar-grid-container');
    const listContainer = document.getElementById('calendar-list-container');
    const calControls = document.getElementById('cal-controls');

    // Usamos 450px como ponto de quebra. Ajuste se necessário.
    if(window.innerWidth < 450) {
        gridContainer.classList.add('hidden');
        listContainer.classList.remove('hidden');
        calControls.classList.add('w-full', 'justify-between'); // Faz os botões ocuparem a largura
    } else {
        gridContainer.classList.remove('hidden');
        listContainer.classList.add('hidden');
        calControls.classList.remove('w-full', 'justify-between');
    }
}


btnPrev.addEventListener('click',()=>{ current = new Date(current.getFullYear(),current.getMonth()-1,1); renderCalendar(); });
btnNext.addEventListener('click',()=>{ current = new Date(current.getFullYear(),current.getMonth()+1,1); renderCalendar(); });
btnToday.addEventListener('click',()=>{ current=new Date(); renderCalendar(); });
const todoInput = document.getElementById('todo-input');
const todoAdd = document.getElementById('todo-add');
const todoList = document.getElementById('todo-list');
function loadTodos(){ return store.get('todos_v1',[]); }
function saveTodos(list){ store.set('todos_v1',list); }
function renderTodos(){
  const todos = loadTodos();
  todoList.innerHTML="";
  todos.forEach((t,idx)=>{
    const li = document.createElement('li');
    li.className="flex items-center gap-3 p-2 rounded-xl border border-slate-200 text-black";
    li.innerHTML=`<input type="checkbox" ${t.done?'checked':''} class="w-5 h-5 rounded-md border-slate-300">
    <span class="flex-1 ${t.done?'line-through text-slate-400':'text-slate-700'} break-anywhere text-sm">${t.text}</span>
    <button class="px-2 py-1 rounded-lg border border-slate-200 hover:bg-slate-50 text-xs">✖</button>`;
    const cb = li.querySelector('input[type=checkbox]');
    cb.addEventListener('change',()=>{
      const updated = loadTodos(); updated[idx].done = !updated[idx].done; saveTodos(updated); renderTodos();
    });
    li.querySelector('button').addEventListener('click',()=>{
      const updated = loadTodos(); updated.splice(idx,1); saveTodos(updated); renderTodos();
    });
    todoList.appendChild(li);
  });
}
function addTodo(){ const text = (todoInput.value||"").trim(); if(!text) return; const todos = loadTodos(); todos.unshift({text,done:false,createdAt:Date.now()}); saveTodos(todos); todoInput.value=""; renderTodos(); }
todoAdd.addEventListener('click',addTodo);
todoInput.addEventListener('keydown',(e)=>{ if(e.key==='Enter') addTodo(); });
const noteNewBtn = document.getElementById('note-new');
const noteForm = document.getElementById('note-form');
const noteTitle = document.getElementById('note-title');
const noteBody = document.getElementById('note-body');
const noteCancel = document.getElementById('note-cancel');
const noteSave = document.getElementById('note-save');
const noteList = document.getElementById('note-list');
let editingIndex = null;
function loadNotes(){ return store.get('notes_v1',[]); }
function saveNotes(list){ store.set('notes_v1',list); }
function openForm(clean=true){ noteForm.classList.remove('hidden'); if(clean){ noteTitle.value=''; noteBody.value=''; editingIndex=null; } noteTitle.focus(); }
function closeForm(){ noteForm.classList.add('hidden'); noteTitle.value=''; noteBody.value=''; editingIndex=null; }
noteNewBtn.addEventListener('click',()=>openForm(true));
noteCancel.addEventListener('click',closeForm);
noteSave.addEventListener('click',()=>{
  const title = noteTitle.value.trim();
  const body = noteBody.value.trim();
  if(!title&&!body) return;
  const notes = loadNotes();
  if(editingIndex===null){ notes.unshift({title,body,createdAt:Date.now(),updatedAt:Date.now()}); }
  else{ notes[editingIndex]={...notes[editingIndex],title,body,updatedAt:Date.now()}; }
  saveNotes(notes); closeForm(); renderNotes();
});
function renderNotes(){
  const notes = loadNotes(); noteList.innerHTML="";
  if(notes.length===0){ const empty=document.createElement('div'); empty.className="text-slate-500 text-sm text-center py-4"; empty.textContent="Sem notas ainda."; noteList.appendChild(empty); return; }
  notes.forEach((n,idx)=>{
    const card=document.createElement('article');
    card.className=`p-3 rounded-2xl border border-slate-200`;
    const title = n.title?`<h3 class="font-medium text-slate-800 mb-1 break-anywhere">${escapeHtml(n.title)}</h3>`:'';
    const bodyPreview = n.body?escapeHtml(n.body).slice(0,280):'';
    const updated = new Date(n.updatedAt||n.createdAt);
    const when = updated.toLocaleString('pt-BR',{dateStyle:'short',timeStyle:'short'});
    card.innerHTML=`${title}${bodyPreview?`<p class="text-slate-700 break-anywhere whitespace-pre-wrap text-sm">${bodyPreview}</p>`:''}
      <div class="mt-2 flex items-center justify-between text-xs text-slate-500">
        <span>${when}</span>
        <div class="flex items-center gap-2">
          <button class="px-2 py-1 rounded-lg border border-slate-200 hover:bg-slate-50">Editar</button>
          <button class="px-2 py-1 rounded-lg border border-rose-200 text-rose-700 hover:bg-rose-50">Excluir</button>
        </div>
      </div>`;
    const [btnEdit,btnDel] = card.querySelectorAll('button');
    btnEdit.addEventListener('click',()=>{ editingIndex=idx; noteTitle.value=n.title||''; noteBody.value=''; openForm(false); });
    btnDel.addEventListener('click',()=>{ const notes=loadNotes(); notes.splice(idx,1); saveNotes(notes); renderNotes(); });
    noteList.appendChild(card);
  });
}
function escapeHtml(str){ return str.replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

function init(){ 
    renderCalendar(); 
    renderTodos(); 
    renderNotes(); 
    handleResponsiveLayout();
}

// Roda a verificação quando a página carrega e quando o tamanho da janela muda
document.addEventListener('DOMContentLoaded',init);
window.addEventListener('resize', handleResponsiveLayout);
</script>
</body>
</html>

